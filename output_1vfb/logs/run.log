2025-12-25 17:57:40,730 - INFO - ============================================================
2025-12-25 17:57:40,730 - INFO - Crystal2HLT-RFInputs Pipeline
2025-12-25 17:57:40,730 - INFO - ============================================================
2025-12-25 17:57:40,731 - INFO - 复制输入文件到 output_1vfb/input/1VFB.cif
2025-12-25 17:57:40,731 - INFO - 读取结构文件: examples/1VFB.cif
2025-12-25 17:57:40,731 - INFO - 检测到文件格式: cif
2025-12-25 17:57:40,745 - INFO - 结构包含 3456 个原子, 3 条链: [np.str_('A'), np.str_('B'), np.str_('C')]
2025-12-25 17:57:40,745 - INFO - 清理结构...
2025-12-25 17:57:40,745 - INFO - 过滤后保留 3408 个蛋白原子 (原 3456 个)
2025-12-25 17:57:40,745 - INFO - ======== V2 FASTA 辅助识别 ========
2025-12-25 17:57:40,822 - INFO - 解析 FASTA 文件: examples/rcsb_pdb_1VFB.fasta
2025-12-25 17:57:40,822 - DEBUG -   FASTA 记录: 1VFB_3|Chain, 链=['C'], 角色=[]
2025-12-25 17:57:40,822 - DEBUG -   FASTA 记录: 1VFB_2|Chain, 链=['B'], 角色=['fv', 'heavy_chain']
2025-12-25 17:57:40,822 - DEBUG -   FASTA 记录: 1VFB_1|Chain, 链=['A'], 角色=['fv', 'light_chain']
2025-12-25 17:57:40,822 - INFO -   解析到 3 条 FASTA 记录
2025-12-25 17:57:40,823 - INFO - 提取到 3 条链序列 (3 蛋白, 0 非蛋白)
2025-12-25 17:57:40,823 - INFO - 映射结构链到 FASTA (mode=auto)...
2025-12-25 17:57:40,824 - INFO -   链 A -> 1VFB_1|Chain (identity=1.00, cov=1.00)
2025-12-25 17:57:40,824 - INFO -   链 B -> 1VFB_2|Chain (identity=1.00, cov=1.00)
2025-12-25 17:57:40,825 - INFO -   链 C -> 1VFB_3|Chain (identity=1.00, cov=1.00)
2025-12-25 17:57:40,825 - INFO -   完成映射: 3 / 3 链成功映射
2025-12-25 17:57:40,825 - INFO - ====================================
2025-12-25 17:57:40,825 - INFO - 识别链角色 (V2: FASTA+ANARCI 融合)...
2025-12-25 17:57:40,826 - INFO - 提取到 3 条链的序列: [np.str_('A'), np.str_('B'), np.str_('C')]
2025-12-25 17:57:40,826 - INFO - 自动识别链角色 (ANARCI + FASTA hint)...
2025-12-25 17:57:40,853 - INFO -   链 A: 轻链 (VL) [ANARCI] [FASTA: fv,light_chain]
2025-12-25 17:57:40,864 - INFO -   链 B: 重链 (VH) [ANARCI] [FASTA: fv,heavy_chain]
2025-12-25 17:57:40,869 - INFO -   链 C: 非抗体 -> 抗原
2025-12-25 17:57:40,869 - INFO - 自动检测模式: antibody
2025-12-25 17:57:40,872 - DEBUG -   B-A: 接触分数 = 6220.0
2025-12-25 17:57:40,872 - INFO -   配对 1: B-A (分数: 6220.0)
2025-12-25 17:57:40,872 - INFO - 选择VH-VL配对: B-A (接触分数: 6220.0)
2025-12-25 17:57:40,872 - INFO - 主抗体: 重链=B, 轻链=A
2025-12-25 17:57:40,872 - INFO - 抗原链: [np.str_('C')]
2025-12-25 17:57:40,872 - INFO - 计算界面残基 (cutoff=4.5Å)...
2025-12-25 17:57:40,886 - INFO -   找到 21 个界面残基
2025-12-25 17:57:40,886 - INFO - 使用 ASU，找到 21 个界面残基
2025-12-25 17:57:40,896 - INFO - ============================================================
2025-12-25 17:57:40,896 - INFO - 为 1 套抗体生成完整输出...
2025-12-25 17:57:40,896 - INFO - ============================================================
2025-12-25 17:57:40,898 - INFO - 
--- 抗体 1: B-A (antibody) ---
2025-12-25 17:57:40,900 - INFO -   该抗体结合的抗原链: [np.str_('C')] (从 1 条中选出)
2025-12-25 17:57:40,900 - INFO - 导出 framework_HLT.pdb...
2025-12-25 17:57:40,915 - INFO -   写入 2143 个原子到 output_1vfb/antibody_1/outputs/framework_HLT.pdb
2025-12-25 17:57:40,915 - INFO -   CDR边界: [('H1', 26, 32), ('H2', 52, 56), ('H3', 98, 105), ('L1', 140, 150), ('L2', 166, 172), ('L3', 205, 213)]
2025-12-25 17:57:40,916 - INFO - 导出 target_HLT.pdb...
2025-12-25 17:57:40,924 - INFO -   写入 1265 个原子到 output_1vfb/antibody_1/outputs/target_HLT.pdb
2025-12-25 17:57:40,924 - INFO - 计算界面残基 (cutoff=4.5Å)...
2025-12-25 17:57:40,938 - INFO -   找到 21 个界面残基
2025-12-25 17:57:40,938 - INFO - 使用 contact_score 方法选择热点...
2025-12-25 17:57:40,942 - INFO -   选择了 8 个热点
2025-12-25 17:57:40,943 - INFO - 生成 design_loops...
2025-12-25 17:57:40,943 - INFO -   antibody.design_loops=[H1:7,H2:5,H3:8,L1:11,L2:7,L3:9]
2025-12-25 17:57:40,943 - INFO -   写入 epitope_patch.txt (21 个残基)
2025-12-25 17:57:40,943 - INFO -   写入 hotspots.txt 和 hotspots_rfantibody.txt
2025-12-25 17:57:40,943 - INFO -   写入 design_loops_rfantibody.txt
2025-12-25 17:57:40,943 - INFO -   写入 cdr_boundaries.json
2025-12-25 17:57:40,945 - INFO -   写入序列文件
2025-12-25 17:57:40,945 - INFO - 执行 HLT 合规性验证...
2025-12-25 17:57:40,949 - INFO -   ✓ 链顺序正确: ['H', 'L']
2025-12-25 17:57:40,950 - INFO -   ✓ REMARK 格式正确: 47 个标注
2025-12-25 17:57:40,952 - INFO -   ✓ hotspots 可定位: 8 个
2025-12-25 17:57:40,952 - INFO - ✓ HLT 合规性验证通过
2025-12-25 17:57:40,953 - INFO -   写入 qc_report.json 和 qc_report.md
2025-12-25 17:57:40,953 - INFO -   ✓ 抗体 1: 21 epitope, 8 hotspots
2025-12-25 17:57:40,953 - INFO - 
生成全局摘要报告...
2025-12-25 17:57:40,953 - INFO -   写入 output_1vfb/summary_report.json
2025-12-25 17:57:40,953 - INFO -   写入 output_1vfb/summary_report.md
2025-12-25 17:57:40,953 - INFO - 
2025-12-25 17:57:40,953 - INFO - ============================================================
2025-12-25 17:57:40,954 - INFO - Pipeline 完成！
2025-12-25 17:57:40,954 - INFO - 输出目录: output_1vfb
2025-12-25 17:57:40,954 - INFO - 抗体目录: antibody_1, antibody_2, ... (共 1 套)
2025-12-25 17:57:40,954 - INFO - ============================================================
